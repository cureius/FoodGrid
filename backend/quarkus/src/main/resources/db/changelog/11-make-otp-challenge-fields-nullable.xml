<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd">

  <changeSet id="11-make-otp-challenge-fields-nullable" author="foodgrid">
    <!-- Make mobileNumber nullable -->
    <modifyDataType 
        tableName="customer_otp_challenges" 
        columnName="mobileNumber" 
        newDataType="VARCHAR(15)"/>
    
    <!-- Make email nullable -->
    <modifyDataType 
        tableName="customer_otp_challenges" 
        columnName="email" 
        newDataType="VARCHAR(255)"/>
    
    <!-- Add comments to clarify the purpose -->
    <comment>
      These changes allow the customer_otp_challenges table to store both mobile-based
      and email-based OTP challenges. For mobile OTPs, email will be null.
      For email OTPs, mobileNumber will be null.
    </comment>
  </changeSet>

</databaseChangeLog>
